#include <iostream.h>
#include <conio.h>
#include <iomanip.h>
#include <process.h>

class play_area
{
 private:
	int board[31][31];
	int neighbour[31][31];
	int board_size;
	void neighbour_calc();

 public:
	play_area(int Bsize);
	void board_with_no();
	void board_cout();
	void alive_cell(int r, int c);
	void next_gen();
};

void about()
{
 cout<<"\n\t ABOUT THE GAME OF LIFE\n";

 cout<<"\n The Game of Life is not your typical computer game. ";
 cout<<" It is a 'cellular automaton', and was invented by Cambridge mathematician John   Conway. ";
 cout<<"\n This game became widely known when it was mentioned in an article published by Scientific American in 1970. ";
 cout<<" It consists of a collection of cells which, based on a few mathematical rules, can live, die or multiply. ";
 cout<<" Depending on the initial conditions, the cells form various patterns throughout the course of the game. ";
 cout<<"\n\n The game is a zero-player game, meaning that its evolution is determined by its initial state, requiring no further input.";
 cout<<" One interacts with the Game of Life by creating an initial configuration and observing how it evolves, or, for advanced players, by creating patterns with particular properties.";
 cout<<" \nThis is just a simple simulation, made by me, of a piece of art made by John Conway.";
 cout<<" \n\nOne can see its better simulation at https://playgameoflife.com/";
}

void rules()
{
 cout<<"\n\t RULES";

 cout<<"\n The universe of the Game of Life is an infinite, two-dimensional orthogonal grid of square cells, each of which is in one of two possible states, alive or dead, (or populated and unpopulated, respectively).";
 cout<<" Every cell interacts with its eight neighbours, which are the cells that are horizontally, vertically, or diagonally adjacent. At each step in time, the following transitions occur:";
 cout<<"\n\n 1.	Any live cell with fewer than two live neighbors dies, as if by underpopulation.";
 cout<<"\n 2.	Any live cell with two or three live neighbors lives on to the next generation.";
 cout<<"\n 3.	Any live cell with more than three live neighbors dies, as if by overpopulation.";
 cout<<"\n 4.	Any dead cell with exactly three live neighbors becomes a live cell, as if by reproduction.";
 cout<<"\n\n The rules continue to be applied repeatedly to create further generations.";
}
void instructions()
{
 cout<<"\n\t INSTRUCTIONS";

 cout<<"\n The Size of the Board can be modified (Maximum Size 30 x 30) while the board will always be a square grid of cells.";
 cout<<"\n One can easily make cells alive at the initiation just by specifying the address of the cell followed by 'y' (For yes) if another cell is to be made alive or by 'n' (For no) if no other cell is to be made alive.";
 cout<<"\n In the following way:";

 cout<<"\n\n (Row Number) (Column Number) ('y' or 'n')";
 cout<<"\n To be noticed that all three of the separated by a space and then enter is to be pressed.";

 cout<<"\n\n Then, number of generations to be formed is specified and then the mode of control which are:";
 cout<<"\n 1.   AUTOMATIC                  [Next generation will be shown automatically after a short interval of time]    {‘a’}";
 cout<<"\n 2.   MANUAL KEYBOARD CONTROL    [Next generation will be showed after getting any key stroke]                   {‘k’}";
 cout<<"\n\n Then just sit back and watch your people populate and die as if you are the god.";
}

void delay()
{
 for(long int w=0;w<10000000;w++); //For Time Delay
}

play_area:: play_area(int Bsize)
{
 int i,j;
 board_size=Bsize;
 for(i=0;i<=board_size+2;i++)
  for(j=0;j<=board_size+2;j++)
   b.board[i][j]=0;
 board_with_no();
}

void play_area:: alive_cell(int r,int c)
{
 b.board[r][c]=1;
}

void play_area:: board_with_no()
{
 for(int i=0;i<board_size+1;i++)
  {
   for(int j=0;j<board_size+1;j++)
   {
    if(i==0 && j!=0)
     cout<<setw(2)<<j;
    else if(j==0 && i!=0)
     cout<<setw(2)<<i;
    else if(i==0 && j==0)
     cout<<setw(2)<<" ";
    else if(board[i][j]==0)
      cout<<setw(2)<<"_";
     else
      cout<<setw(2)<<"*";
   }
   cout<<"\n";
  }
}

void play_area::board_cout()
{
 for(int i=1;i<board_size+1;i++)
 {
  for(int j=1;j<board_size+1;j++)
  {
   if(board[i][j]==0)
    cout<<setw(2)<<"_";
   else
    cout<<setw(2)<<"*";
  }
  cout<<"\n";
 }
}

void play_area:: neighbour_calc()
{
 int p, q;
 for(int i=1;i<board_size+1;i++)
 {
  for(int j=1;j<board_size+1;j++)
  {
   if(board[i][j]==1)
    neighbour[i][j]=-1;
   else
    neighbour[i][j]=0;
   for(p=-1;p<=1;p++)
    {
     for(q=-1;q<=1;q++)
    {
      neighbour[i][j]+=board[i+p][j+q];
    }//for(q)
   }//for(p)
  }//for(j)
 }//for(i)
}

void play_area:: next_gen()
{
 neighbour_calc();
 for(int i=1;i<board_size+1;i++)
 {
  for(int j=1;j<board_size+1;j++)
  {
   if(board[i][j]==1 && (neighbour[i][j]>3 || neighbour[i][j]<2) )
    board[i][j]=0;
   else if(board[i][j]==0 && neighbour[i][j]==3 )
    board[i][j]=1;
  }//for(i)
 }//for(j)
}

void play()
{
 int BoardSize, row, column, i, j, gen, g;
 char continu, control;
 cout<<"\n\t Play CONWAY'S GAME OF LIFE";
 cout<<"\n\nEnter Size of Board:";
 cin>>BoardSize;
 play_area b(BoardSize);

 clrscr();

 do
 {
  cout<<"Enter Cell's address to be made alive:";
  cin>>row>>column;
  cin>>continu;

  b.alive_cell(row,column);

  clrscr();

  b.board_with_no();

 }while(continu=='y'|| continu=='Y');

 cout<<"Number Of Generations to be generated:";
 cin>>gen;
 clrscr();
 cout<<"Enter mode of control: \n";
 control_label:
 cout<<"( Automatic {'a'} OR Keyboard {'k'} )\n";
 control=getch();

 for(g=0;g<gen;g++)
 {
  if(control=='k')
   getch();
  else if(control=='a')
   delay();
  else
  {
   cout<<"\nInvalid Choice!, Enter mode of control again:";
   goto control_label;
  }
  clrscr();

  b.next_gen();
  cout<<"GENERATION "<<g+1<<endl;
  b.board_cout();

 }//for(gen)
}



void main()
{
 char choice;
 home:
 clrscr();
 cout<<"\t\t\t_CONWAY'S GAME OF LIFE_\n\n";
 cout<<"\tHome:\n\n";
 cout<<"1. About The Game Of Life       {'a'}\n";
 cout<<"2. Rules                        {'r'}\n";
 cout<<"3. Instructions                 {'i'}\n";
 cout<<"4. Play                         {Enter}\n";
 cout<<"5. Quit                         {Esc}\n";
 cout<<"\nEnter Choice:";
 label1:
 choice=getch();
 switch(choice)
 {
  case 'a':
  case 'A':clrscr();
	   about();
	   break;
  case 'r':
  case 'R':clrscr();
	   rules();
	   break;
  case 'i':
  case 'I':clrscr();
	   instructions();
	   break;
  case 13 :clrscr();
	   play();
	   break;
  case 27 :exit(0);
	   break;
  default: cout<<"\nInvalid Choice";
	   cout<<"\nEnter Choice Again:";
	   goto label1;
 }
 cout<<"\n\nPress Tab for Home";
 cout<<"\nPress Esc for Exit\n";
 label2:
 choice=getch();
 switch(choice)
 {
  case 9  :goto home;
  case 27 :exit(0);
	   break;
  default :cout<<"Invalid Choice";
	   cout<<"\nEnter Choice Again:";
	   goto label2;
 }
 getch();
}
